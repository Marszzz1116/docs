import{_ as s,c as i,o as a,U as e}from"./chunks/framework.-9Q_U4ls.js";const y=JSON.parse('{"title":"Error: ENOSPC: System limit for number of file watchers reached","description":"","frontmatter":{},"headers":[],"relativePath":"常见问题/node-error-01.md","filePath":"常见问题/node-error-01.md","lastUpdated":1705116614000}'),n={name:"常见问题/node-error-01.md"},t=e(`<h1 id="error-enospc-system-limit-for-number-of-file-watchers-reached" tabindex="-1">Error: ENOSPC: System limit for number of file watchers reached <a class="header-anchor" href="#error-enospc-system-limit-for-number-of-file-watchers-reached" aria-label="Permalink to &quot;Error: ENOSPC: System limit for number of file watchers reached&quot;">​</a></h1><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ==================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Author : mikigo</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ==================================</span></span></code></pre></div><p>报错的原始输出：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node:internal/errors:490</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ErrorCaptureStackTrace(err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ^</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ENOSPC:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> limit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> watchers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reached,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> watch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/home/uos/github/muyi-frontend/.env.development&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FSWatcher.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">compute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (node:internal/fs/watchers:247:19)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Object.watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (node:fs:2343:34)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> createFsWatchInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:50470:17)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setFsWatchListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:50517:15)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NodeFsHandler._watchWithNodeFs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:50672:14)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NodeFsHandler._handleFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:50736:23)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NodeFsHandler._addToNodeFs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:50978:21)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Emitted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;error&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> event</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FSWatcher</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FSWatcher._handleError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:52169:10)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NodeFsHandler._addToNodeFs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file:///home/uos/github/muyi-frontend/node_modules/.pnpm/vite@4.3.9_@types+node@20.3.1_sass@1.63.6_terser@5.18.1/node_modules/vite/dist/node/chunks/dep-e8f070e8.js:50986:18) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  errno:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -28,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  syscall:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;watch&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  code:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ENOSPC&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/home/uos/github/muyi-frontend/.env.development&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  filename:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/home/uos/github/muyi-frontend/.env.development&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>达到文件观察者数量的系统限制；</p><p>错误产生的原因是负责监控 Linux 文件系统的 <code>inotify</code> 程序达到了系统默认的限制上限；</p><p><code>inotify</code> 提供了一种监控文件系统（基于 <code>inode</code> 的）事件的机制，可以监控文件系统的变化如文件修改、新增、删除等，并可以将相应的事件通知给应用程序。</p><p>查看 <code>inotify</code> 在内核中的默认配置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uos@uos-PC:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fs.inotify</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fs.inotify.max_queued_events</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16384</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fs.inotify.max_user_instances</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 128</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fs.inotify.max_user_watches</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8192</span></span></code></pre></div><p><strong>解决方法</strong></p><p>临时解决：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fs.inotify.max_user_watches=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span></span></code></pre></div><p>永久解决：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fs.inotify.max_user_watches=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/sysctl.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></div>`,14),h=[t];function l(p,k,d,r,o,F){return a(),i("div",null,h)}const g=s(n,[["render",l]]);export{y as __pageData,g as default};
